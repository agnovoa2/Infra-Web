<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:a="http://xmlns.jcp.org/jsf/passthrough"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:o="http://xmlns.jcp.org/jsf/html">
<f:metadata>
	<f:event listener="#{loginController.redirectIfAnonymous()}"
		type="preRenderView" />
	<f:event listener="#{loginController.redirectIfNotIntern()}"
		type="preRenderView" />
</f:metadata>
<h:head>
	<title>Infraestructura ESEI</title>
</h:head>
<h:body>
	<h2>Gesti√≥n de usuarios</h2>
	<h:panelGroup id="users">
		<h3>Estudiantes</h3>
		<o:form id="studentForm">
			<ui:repeat var="user" value="#{userManagement.allStudents}">
				<h:outputLabel value="#{user.toString()}" />
				&nbsp;
				<h:commandLink action="#{userManagement.doBanUnban(user.login)}"
					value="Impedir acceso"
					rendered="#{!userManagement.isUserBanned(user.login)}">
					<f:ajax render="@form" />
				</h:commandLink>
				<h:commandLink action="#{userManagement.doBanUnban(user.login)}"
					value="Permitir acceso"
					rendered="#{userManagement.isUserBanned(user.login)}">
					<f:ajax render="@form" />
				</h:commandLink>
				<a href="editProfile?#{user.login}">Editar</a>
				&nbsp;
				<h:commandLink action="#{userManagement.promoteToIntern(user.login)}"
					value="Hacer becario">
					<f:ajax render="@form users internForm" />
				</h:commandLink>
				&nbsp;
				<h:commandLink action="#{userManagement.promoteToProfessor(user.login)}"
					value="Hacer profesor">
					<f:ajax render="@form users professorForm" />
				</h:commandLink>
				<br/>
			</ui:repeat>
		</o:form>
		<o:form id="professorForm">
			<h3>Profesors</h3>
			<ui:repeat var="user" value="#{userManagement.allProfessors}">
				<h:outputLabel value="#{user.toString()}" />
				&nbsp;
				<a href="editProfile?#{user.login}">Editar</a>
				&nbsp;
				<h:commandLink action="#{userManagement.degradeToStudent(user.login)}"
					value="Ya no es profesor" rendered="#{!userManagement.isMe(user.login)}">
					<f:ajax render="@form users studentForm" />
				</h:commandLink>
				<br/>
			</ui:repeat>
		</o:form>
		<o:form id="internForm">
			<h3>Becarios</h3>
			<ui:repeat var="user" value="#{userManagement.allInterns}">
				<h:outputLabel value="#{user.toString()}" />
				&nbsp;
				<h:commandLink action="#{userManagement.degradeToStudent(user.login)}"
					value="Ya no es becario" rendered="#{!userManagement.isMe(user.login)}">
					<f:ajax render="@form users studentForm" />
				</h:commandLink>
				&nbsp;
				<a href="editProfile?#{user.login}">Editar</a>
				<br/>
			</ui:repeat>
		</o:form>
	</h:panelGroup>
</h:body>
</html>