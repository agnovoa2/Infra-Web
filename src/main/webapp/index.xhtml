<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="es" xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:o="http://xmlns.jcp.org/jsf/html">
<f:metadata>
	<f:event listener="#{loginController.redirectToLogin()}"
		type="preRenderView" />
</f:metadata>
<h:head>
	<title>Infraestructura ESEI</title>
</h:head>
<h:body>
	<ui:composition template="/template/layout.xhtml">
		<ui:define name="content">
			<div class="row">
				<div class="col-md-6">
					<div class="row">
						<h:panelGroup
							rendered="#{index.allIncidences.size() > 0 and loginController.intern}">
							<div class="col-md-12">
								<div class="box box-danger">
									<div class="box-header with-border">
										<h3 class="box-title">
											<i class="fa fa-exclamation-triangle" /> Incidencias
											pendientes <span class="label label-danger">#{index.allIncidences.size()}</span>
										</h3>
										<div class="box-tools pull-right">
											<button class="btn btn-box-tool" data-widget="collapse">
												<i class="fa fa-minus"></i>
											</button>
										</div>
									</div>
									<div class="box-body">
										<div class="box-body table-responsive no-padding">
											<h:dataTable var="incidence" value="#{index.allIncidences}"
												class="table table-hover">
												<h:column>
													<f:facet name="header">Ubicación</f:facet>    				
								            #{incidence.computer.laboratory}
								    </h:column>
												<h:column>
													<f:facet name="header">Número ordenador</f:facet>    				
								            #{incidence.computer.labelNum}
								    </h:column>
												<h:column>
													<f:facet name="header">Descripción</f:facet>    				
								            #{incidence.description}
								    </h:column>
											</h:dataTable>
										</div>
									</div>
								</div>
							</div>
						</h:panelGroup>
						<!-- fin del bloque de incidencias -->
						<h:panelGroup
							rendered="#{index.allIncidences.size() == 0 and loginController.intern}">
							<div class="col-md-12">
								<div class="box box-success">
									<div class="box-header with-border">
										<h3 class="box-title">
											<i class="fa fa-exclamation-triangle" /> Incidencias
											pendientes
										</h3>
										<div class="box-tools pull-right">
											<button class="btn btn-box-tool" data-widget="collapse">
												<i class="fa fa-minus"></i>
											</button>
										</div>
									</div>
									<div class="box-body">
										<h3>
											No hay incidencias en la escuela.<br />¡Buen trabajo!
										</h3>
									</div>
								</div>
							</div>
						</h:panelGroup>
						<!-- fin del bloque de incidencias -->
						<h:panelGroup
							rendered="#{index.allConsumablePetitions.size() > 0 and loginController.intern}">
							<div class="col-md-12">
								<div class="box box-warning">
									<div class="box-header with-border">
										<h3 class="box-title">
											<i class="fa fa-print" /> Peticiones de consumibles
											pendientes <span class="label label-warning">#{index.allConsumablePetitions.size()}</span>
										</h3>
										<div class="box-tools pull-right">
											<button class="btn btn-box-tool" data-widget="collapse">
												<i class="fa fa-minus"></i>
											</button>
										</div>
									</div>
									<div class="box-body">
										<div class="box-body table-responsive no-padding">
											<h:dataTable var="consumablePetition"
												value="#{index.allConsumablePetitions}"
												class="table table-hover">
												<h:column>
													<f:facet name="header">Solicitante</f:facet>    				
								            #{consumablePetition.user.toString()}
								    	</h:column>
												<h:column>
													<f:facet name="header">Impresora</f:facet>    				
								            #{consumablePetition.printer.model.modelName}
								    	</h:column>
											</h:dataTable>
										</div>
									</div>
								</div>
							</div>

						</h:panelGroup>
						<!-- Fin del bloque de peticiones de consumibles -->
						<h:panelGroup
							rendered="#{index.allConsumablePetitions.size() == 0 and loginController.intern}">
							<div class="col-md-12">
								<div class="box box-success">
									<div class="box-header with-border">
										<h3 class="box-title">
											<i class="fa fa-print" /> Peticiones de consumibles
										</h3>
										<div class="box-tools pull-right">
											<button class="btn btn-box-tool" data-widget="collapse">
												<i class="fa fa-minus"></i>
											</button>
										</div>
									</div>
									<div class="box-body">
										<h3>No hay peticiones de consumibles pendientes.</h3>
									</div>
								</div>
							</div>
						</h:panelGroup>
					</div>
					<!-- Fin del bloque de peticiones de consumibles -->
				</div>
				<div class="col-md-6">
					<h:panelGroup
						rendered="#{index.allUnsolvedSoftwarePetitions.size() > 0 and loginController.intern}">
						<div class="col-md-12">
							<div class="box box-warning">
								<div class="box-header with-border">
									<h3 class="box-title">
										<i class="fa fa-tv" /> Peticiones de software pendientes <span
											class="label label-warning">#{index.allUnsolvedSoftwarePetitions.size()}</span>
									</h3>
									<div class="box-tools pull-right">
										<button class="btn btn-box-tool" data-widget="collapse">
											<i class="fa fa-minus"></i>
										</button>
									</div>
								</div>
								<div class="box-body">
									<div class="box-body table-responsive no-padding">
										<h:dataTable var="subject"
											value="#{index.allUnsolvedSoftwarePetitions}"
											class="table table-hover">
											<h:column>
												<f:facet name="header">Asignatura</f:facet>    				
								            #{subject.subjectName}
								    	</h:column>
											<h:column>
												<f:facet name="header">Código</f:facet>    				
								            #{subject.code}
								    	</h:column>
											<h:column>
												<f:facet name="header">Licenciatura</f:facet>    				
								            #{subject.degree.toString()}
								    	</h:column>
										</h:dataTable>
									</div>
								</div>
							</div>
						</div>
					</h:panelGroup>
					<!-- Fin del bloque de peticiones de software -->
					<h:panelGroup
						rendered="#{index.allUnsolvedSoftwarePetitions.size() == 0 and loginController.intern}">
						<div class="col-md-12">
							<div class="box box-success">
								<div class="box-header with-border">
									<h3 class="box-title">
										<i class="fa fa-tv" /> Peticiones de software pendientes
									</h3>
									<div class="box-tools pull-right">
										<button class="btn btn-box-tool" data-widget="collapse">
											<i class="fa fa-minus"></i>
										</button>
									</div>
								</div>
								<div class="box-body">
									<h3>No hay peticiones de software pendientes.</h3>
								</div>
							</div>
						</div>
					</h:panelGroup>
					<h:panelGroup
						rendered="#{index.allMaterialPetitions.size() > 0 and loginController.intern}">
						<div class="col-md-12">
							<div class="box box-warning">
								<div class="box-header with-border">
									<h3 class="box-title">
										<i class="fa fa-dropbox" /> Peticiones de materiales
										pendientes <span class="label label-warning">#{index.allMaterialPetitions.size()}</span>
									</h3>
									<div class="box-tools pull-right">
										<button class="btn btn-box-tool" data-widget="collapse">
											<i class="fa fa-minus"></i>
										</button>
									</div>
								</div>
								<div class="box-body">
									<div class="box-body table-responsive no-padding">
										<h:dataTable var="materialPetition"
											value="#{index.allMaterialPetitions}"
											class="table table-hover">
											<h:column>
												<f:facet name="header">Solicitante</f:facet>    				
								            #{materialPetition.user.toString()}
								    	</h:column>
											<h:column>
												<f:facet name="header">Tipo de usuario</f:facet>    				
								            #{materialPetition.user.role.toString()}
								    	</h:column>
										</h:dataTable>
									</div>
								</div>
							</div>
						</div>
					</h:panelGroup>
					<!-- Fin del bloque de peticiones de materiales -->
					<h:panelGroup
						rendered="#{index.allMaterialPetitions.size() == 0 and loginController.intern}">
						<div class="col-md-12">
							<div class="box box-success">
								<div class="box-header with-border">
									<h3 class="box-title">
										<i class="fa fa-dropbox" /> Peticiones de materiales
									</h3>
									<div class="box-tools pull-right">
										<button class="btn btn-box-tool" data-widget="collapse">
											<i class="fa fa-minus"></i>
										</button>
									</div>
								</div>
								<div class="box-body">
									<h3>No hay peticiones de materiales pendientes.</h3>
								</div>
							</div>
						</div>
					</h:panelGroup>
					<!-- Fin del bloque de peticiones de materiales -->
				</div>
				<!-- Fin del bloque de peticiones de software -->


				<h:panelGroup
					rendered="#{index.myConsumablePetitions.size() > 0 and loginController.professor}">
					<div class="col-md-6">
						<div class="box box-success">
							<div class="box-header with-border">
								<h3 class="box-title">
									<i class="fa fa-print" /> Mis peticiones de consumibles <span
										class="label label-success">#{index.myConsumablePetitions.size()}</span>
								</h3>
								<div class="box-tools pull-right">
									<button class="btn btn-box-tool" data-widget="collapse">
										<i class="fa fa-minus"></i>
									</button>
								</div>
							</div>
							<div class="box-body">
								<div class="box-body table-responsive no-padding">
									<h:dataTable var="consumablePetition"
										value="#{index.myConsumablePetitions}"
										class="table table-hover">
										<h:column>
											<f:facet name="header">Impresora</f:facet>    				
								            #{consumablePetition.printer.model.modelName}
								    	</h:column>
										<h:column>
											<f:facet name="header">Ubicación</f:facet>    				
								            #{consumablePetition.printer.ubication}
								    	</h:column>
										<h:column>
											<f:facet name="header">Consumibles</f:facet>
											<ui:repeat var="consumableRow"
												value="#{consumablePetition.petitionRows}">
												#{consumableRow.consumable.toString()} #{consumableRow.quantity} <br />
											</ui:repeat>
										</h:column>
										<h:column>
											<f:facet name="header">Eliminar</f:facet>
											<o:form>
												<h:commandLink
													action="#{index.doRemoveConsumablePetition(consumablePetition.petitionNumber)}"
													value="">
													<i class="fa fa-remove text-red"></i>
												</h:commandLink>
											</o:form>
										</h:column>
									</h:dataTable>
								</div>
							</div>
						</div>
					</div>
				</h:panelGroup>
				<!-- Fin del bloque de mis peticiones de consumibles -->
				<h:panelGroup
					rendered="#{index.myConsumablePetitions.size() == 0 and loginController.professor}">
					<div class="col-md-6">
						<div class="box box-success">
							<div class="box-header with-border">
								<h3 class="box-title">
									<i class="fa fa-print" /> Peticiones de consumibles
								</h3>
								<div class="box-tools pull-right">
									<button class="btn btn-box-tool" data-widget="collapse">
										<i class="fa fa-minus"></i>
									</button>
								</div>
							</div>
							<div class="box-body">
								<h3>No tengo peticiones de consumibles pendientes.</h3>
							</div>
						</div>
					</div>
				</h:panelGroup>
				<!-- Fin del bloque de mis peticiones de consumibles -->
				<h:panelGroup
					rendered="#{index.myMaterialPetitions.size() > 0 and (loginController.professor or loginController.student)}">
					<div class="col-md-6">
						<div class="box box-success">
							<div class="box-header with-border">
								<h3 class="box-title">
									<i class="fa fa-dropbox" /> Mis peticiones de materiales <span
										class="label label-success">#{index.myMaterialPetitions.size()}</span>
								</h3>
								<div class="box-tools pull-right">
									<button class="btn btn-box-tool" data-widget="collapse">
										<i class="fa fa-minus"></i>
									</button>
								</div>
							</div>
							<div class="box-body">
								<div class="box-body table-responsive no-padding">
									<h:dataTable var="materialPetition"
										value="#{index.myMaterialPetitions}" class="table table-hover">
										<h:column>
											<f:facet name="header">Material</f:facet>
											<ui:repeat var="materialRow"
												value="#{materialPetition.petitionRows}">
								            	#{materialRow.material.materialName}
								            </ui:repeat>
										</h:column>
										<h:column>
											<f:facet name="header">Cantidad</f:facet>
											<ui:repeat var="materialRow"
												value="#{materialPetition.petitionRows}">
								            	#{materialRow.quantity}
								            </ui:repeat>
										</h:column>
										<h:column>
											<f:facet name="header">Eliminar petición</f:facet>
											<o:form>
												<h:commandLink
													action="#{index.doRemoveMaterialPetition(materialPetition.materialPetitionNumber)}"
													value="">
													<i class="fa fa-remove text-red"></i>
												</h:commandLink>
											</o:form>
										</h:column>
									</h:dataTable>
								</div>
							</div>
						</div>
					</div>
				</h:panelGroup>
				<!-- Fin del bloque de mis peticiones de materiales -->
				<h:panelGroup
					rendered="#{index.myMaterialPetitions.size() == 0 and (loginController.professor or loginController.student)}">
					<div class="col-md-6">
						<div class="box box-success">
							<div class="box-header with-border">
								<h3 class="box-title">
									<i class="fa fa-dropbox" /> Peticiones de materiales
								</h3>
								<div class="box-tools pull-right">
									<button class="btn btn-box-tool" data-widget="collapse">
										<i class="fa fa-minus"></i>
									</button>
								</div>
							</div>
							<div class="box-body">
								<h3>No tengo peticiones de materiales pendientes.</h3>
							</div>
						</div>
					</div>
				</h:panelGroup>
				<!-- Fin del bloque de mis peticiones de materiales -->
				<h:panelGroup rendered="#{loginController.professor}">
					<div class="col-md-12">
						<div class="box box-success">
							<div class="box-header with-border">
								<h3 class="box-title">
									<i class="fa fa-tv" /> Peticiones de software
								</h3>
								<div class="box-tools pull-right">
									<button class="btn btn-box-tool" data-widget="collapse">
										<i class="fa fa-minus"></i>
									</button>
								</div>
							</div>
							<div class="box-body">
								<h:dataTable var="softwarePetition"
									value="#{index.mySoftwarePetitions}" class="table table-hover">
									<h:column>
										<f:facet name="header">Asignatura</f:facet>
											#{softwarePetition.subjectName}
										</h:column>
									<h:column>
										<f:facet name="header">Software</f:facet>
										<ui:repeat var="software"
											value="#{softwarePetition.softwares}">
								            	#{software.softwareName}
								            	<br />
										</ui:repeat>
									</h:column>
									<h:column>
										<f:facet name="header">Descripción</f:facet>
											#{softwarePetition.description}
										</h:column>
									<h:column>
										<f:facet name="header">Estado</f:facet>
										<h:outputText value="En espera"
											rendered="#{softwarePetition.petitionState == 1}" />
										<h:outputText value="Confirmada"
											rendered="#{softwarePetition.petitionState == 2}" />
									</h:column>
									<h:column>
										<f:facet name="header">Repetir petición</f:facet>
										<h:link class="fa fa-reply green-text"
											outcome="softwarePetition?code=#{softwarePetition.code}"
											rendered="#{softwarePetition.petitionState == 2}" />
									</h:column>
									<h:column>
										<f:facet name="header">Eliminar petición</f:facet>
										<o:form>
											<h:commandLink
												action="#{index.doRemoveSoftwarePetition(softwarePetition.subjectName)}"
												value="">
												<i class="fa fa-remove text-red"></i>
											</h:commandLink>
										</o:form>
									</h:column>
								</h:dataTable>
							</div>
						</div>
					</div>
				</h:panelGroup>
				<!-- Fin del bloque de mis peticiones de materiales -->
			</div>
		</ui:define>
	</ui:composition>
</h:body>
</html>